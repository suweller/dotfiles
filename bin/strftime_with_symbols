#!/usr/bin/env bash

set -euo pipefail

# | Day       | Planet  | UTF | Escape Sequence |
# | Sunday    | Sun     | ☉   | \u2609          |
# | Monday    | Moon    | ☽   | \u263D          |
# | Tuesday   | Mars    | ♂   | \u2642          |
# | Wednesday | Mercury | ☿   | \u263F          |
# | Thursday  | Jupiter | ♃   | \u2643          |
# | Friday    | Venus   | ♀   | \u2640          |
# | Saturday  | Saturn  | ♄   | \u2644          |
days_astrological_sign() {
  local v=("\u2609" "\u263D" "\u2642" "\u263F" "\u2643" "\u2640" "\u2644")
  local i=$(( $(printf '%(%w)T\n' -1) ))
  printf "%b" "${v[i]}"
}

days_kanji() {
  local v=(㊐ ㊊ ㊋ ㊌ ㊍ ㊎ ㊏)
  local i=$(( $(printf '%(%w)T\n' -1) ))
  echo "${v[i]}"
}

hours_icon() {
  local v=(󱑖 󱑋 󱑌 󱑍 󱑎 󱑏 󱑐 󱑑 󱑆 󱑇 󱑈 󱑉 󱑊 󱐿 󱑀 󱑁 󱑂 󱑃 󱑄 󱑅 󱑒 󱑓 󱑔 󱑕)
  local i=$((10#$(printf '%(%H)T\n' -1)))
  echo "${v[i]}"
}

hours_quarter() {
  local v=(◷ ◶ ◵ ◴)
  local i=$(( $(printf '%(%M)T') / 15 ))
  echo "${v[i]}"
}

fmt="$1"
case "$fmt" in
  *%as*) fmt="${fmt//%as/$(days_astrological_sign)}" ;;
  *%ak*) fmt="${fmt//%ak/$(days_kanji)}" ;;
esac
case "$fmt" in
  *%HI*) fmt="${fmt//%HI/$(hours_icon)}" ;;
esac
case "$fmt" in
  *%HQ*) fmt="${fmt//%HQ/$(hours_quarter)}" ;;
esac
printf '%s\n' "$fmt"
